$laptop=eDP-1
$screen=DP-1
$term=foot
$speed=4

monitor=$laptop,2880x1800@120,375x1440,1.6666,vrr,1,bitdepth,10,cm,hdr
monitor=$screen,5120x1440@240,0x0,1.0,vrr,1,bitdepth,10,cm,hdr

bindl=,switch:on:Lid Switch,exec,powerprofilesctl set power-saver; hypr-lid on
bindl=,switch:off:Lid Switch,exec,powerprofilesctl set balanced; hypr-lid off
exec=grep -q closed /proc/acpi/button/lid/LID/state && hypr-lid on

exec-once=hypr-plugins-load

exec-once=hypridle
exec-once=swww-daemon
exec-once=wallpaper auto
exec-once=hyprsunset

exec-once=udiskie
exec-once=dunst
exec-once=foot --server
exec-once=systemctl --user start hyprpolkitagent

exec-once=hypr-watch-monitors
exec-once=hypr-watch-windows

exec-once=sleep 2 && quickshell -p ~/nix/dotfiles/quickshell/Bar.qml
exec-once=sleep 5 && cat $(which satty) $(ldd $(which satty) 2>/dev/null | awk '/=>/{print $3}') > /dev/null 2>&1


workspace = 1, monitor:$screen
workspace = 2, monitor:$screen
workspace = 3, monitor:$screen
workspace = 4, monitor:$screen
workspace = 5, monitor:$screen
workspace = 6, monitor:$screen

workspace = 7, monitor:$laptop
workspace = 8, monitor:$laptop
workspace = 9, monitor:$laptop
workspace = 10, monitor:$laptop

workspace = special:bt, monitor:$screen, on-created-empty:[float; size 900 (monitor_h*0.7); center] foot -e 'bluetuith'
bind = SUPER,B, togglespecialworkspace, bt

workspace = special:audio, monitor:$screen, on-created-empty:[float; size 1100 (monitor_h*0.6); center] foot -e 'wiremix'
bind = SUPER,G, togglespecialworkspace, audio

workspace = special:obsidian, monitor:$screen, on-created-empty:[float; size 1500 (monitor_h*0.9); center] obsidian
bind = SUPER,N, togglespecialworkspace, obsidian

workspace = special:term, monitor:$screen, on-created-empty:[float; size (monitor_w*0.7) (monitor_h*0.7); move (monitor_w*0.15) 16] $term sh -c "printf '\n%.0s' {1..100}; exec $SHELL"
bind = SUPER,grave, togglespecialworkspace, term


workspace = special:gpt, monitor:$screen, on-created-empty: firefox --new-window 'https://gpt.yof.sh'
bind = SUPER,R, togglespecialworkspace, gpt

# workspace = special:ha, monitor:$screen, on-created-empty: firefox --new-window 'http://ha:8123'
# bind = SUPER,H, togglespecialworkspace, ha

workspace = special:music, monitor:$screen, on-created-empty: firefox --new-window 'https://music.youtube.com'
bind = SUPER,M, togglespecialworkspace, music

workspace = special:tg, monitor:$screen, on-created-empty: AyuGram
bind = SUPER,W, togglespecialworkspace, tg

bind = SUPER,escape, togglespecialworkspace, togglespecialworkspace
bind = SUPER SHIFT, escape, movetoworkspace, special
bind = SUPER CTRL, escape, movetoworkspacesilent, special

xwayland {
  force_zero_scaling = false
  use_nearest_neighbor = false
}

plugin {
  hyprexpo {
    columns = 3
    skip_empty=true
    gap_size = 0
    bg_col = rgb(111111)
    workspace_method = center current
  }

  darkwindow {
    shader[chromablur] {
      from = chromakey
      introduces_transparency = true
    }
  }

  hyprscrolling {
    column_width = 0.5
    fullscreen_on_one_column = true
  }
}

# Colorkey keybinds - toggle chromakey on active window
# Dark background with blur
bind = SUPER ALT, C, darkwindow:shadeactive, chromakey bkg=[.17 .17 .17]
# Remove shader from active window
bind = SUPER ALT SHIFT, C, darkwindow:shadeactive, none





input {
  kb_file=
  kb_layout=us,ru,ua
  # kb_layout=us,ru
  kb_variant=
  kb_model=
  kb_options=grp:caps_toggle
  kb_rules=
  natural_scroll=false

  repeat_rate=80
  repeat_delay=190

  follow_mouse=0
  # mouse_refocus=1
  float_switch_override_focus=0

  touchpad {
    natural_scroll=no
    scroll_factor=0.333
  }

  sensitivity=0 # -1.0 - 1.0, 0 means no modification.
}
misc {
  disable_splash_rendering = true
  disable_hyprland_logo = true
  focus_on_activate = false
  vfr = true

  # enable_swallow = true
  # swallow_regex = ^(foot)$
}

debug {
  overlay=false
  disable_logs=1
}

render {
  cm_enabled = true
  cm_fs_passthrough = 1
}

binds {
  workspace_back_and_forth=true
}

general {
  gaps_in=5
  gaps_out=5

  border_size=1
  col.active_border = rgba(33ccff88) rgba(bab34e88) 45deg
  #col.active_border = rgba(468be0ee) rgba(bab34eee) 45deg
  col.inactive_border = rgba(59595900)

  # layout = scrolling
  layout = dwindle
# layout = master
  # apply_sens_to_raw=0 # whether to apply the sensitivity to raw input (e.g. used by games where you aim using your mouse)
}

decoration {
  rounding = 0
  dim_special=0.4

  dim_inactive=true
  dim_strength=0.25

  blur {
    enabled = true
    size = 4
    passes = 5
    brightness = 0.7
    vibrancy_darkness = 1
    # xray = true
    # special = true
    # ignore_opacity = true
  }

   shadow { 
     enabled = false
   }
}

animations {
  enabled=1
  bezier = myBezier, 0.05, 0.9, 0.1, 1.05

  animation = windows, 1, $speed, myBezier, slide top
  animation = windowsOut, 1,$speed, myBezier, popin 10%
  animation = border, 1, $speed, myBezier
  animation = borderangle, 1, $speed, myBezier
  animation = fade, 1, $speed, myBezier
  animation = workspaces, 0,$speed, myBezier
}

dwindle {
  pseudotile = true 
  preserve_split = true
}

master {
  orientation = center
}

gestures {
  gesture = 3, horizontal, workspace
}


bindm=SUPER,mouse:272,movewindow
bindm=SUPER,mouse:273,resizewindow

bind=SUPER_SHIFT,RETURN,exec, [float] $term 
bind=SUPER,RETURN,exec, $term
bind=SUPER,D,exec,vicinae toggle
bind=SUPER_SHIFT,D,exec,wofi -i -M=fuzzy --show drun --allow-images


bind=SUPER,E,exec,dunstctl close
bind=SUPER+SHIFT,E,exec,dunstctl history-pop
bind=SUPER+SHIFT+CTRL,E,exec,dunstctl close-all
bind=SUPER+SHIFT,period,exec,dunstctl context

bind=SUPER,A,exec,pactl set-source-mute @DEFAULT_SOURCE@ toggle

bind=SUPER,V,exec,voice dictate toggle
bind=SUPER ALT,V,exec,voice claude toggle
bind=CTRL SUPER,V,exec,MAX_THINKING_TOKENS=0 CLAUDE_EXTRA_ARGS="--model sonnet" voice claude toggle
bind=SUPER SHIFT,V,exec,voice stream toggle

bind=SUPER,I,exec,ocr
bind=SUPER SHIFT,I,exec,lens
bind=SUPER,O,exec,scan-barcode
bind=SUPER,U,exec,bt-audio-status toggle

bind=SUPER+CTRL,H,exec,xdg-open 'http://hermes:8123/'

bind=SUPER,F2,exec,firefox
bind=SUPER+SHIFT,F2,exec,google-chrome-stable

bind=SUPER CTRL,F2,exec,google-chrome-stable

bind=SUPER,F3,exec,setsid $term -e zsh -c 'source ~/.zshrc; nvim' ;

bind=SUPER,F4,exec,setsid $term -e zsh -c 'source ~/.zshrc; cd ~/nix; nvim ~/nix/nixos/configuration.nix' ;
bind=SUPER,F5,exec,setsid $term -e zsh -c 'source ~/.zshrc; cd ~/nix/dotfiles/; nvim ~/nix/dotfiles/hypr/hyprland.conf' ;


bind=SUPER+CTRL,W,exec,[float; size 593 740; center] $term --title 'FT Weather' -e sh -c 'curl -s v2.wttr.in/Blanes | less -r' ;
bind=SUPER+CTRL,P,exec,[float] $term --title 'FT WIFIPW' -e sh -c 'nmcli dev wifi show-password; read' ;
bind=SUPER+CTRL,E,exec,[float; size (monitor_w*0.8) (monitor_h*0.8); center] $term --title 'FT pingtest' -e sh -c "gping -b 20 8.8.8.8 \"$(ip r | grep default | awk '{print $3}')\" "

bind=SUPER+CTRL,J,exec,$term -e sh -c 'journalctl -f -n3000 | lnav -t'


bind=SUPER,F7,exec,meeting-check cam
bind=SUPER,F8,exec,meeting-check mic


bind=SUPER,F12,exec,screen-record region
bind=SUPER+SHIFT,F12,exec,screen-record full



$translate_submap=Translate

bind=SUPER,X,submap,$translate_submap

submap=$translate_submap

bind=,Z,exec,translate en
bind=,X,exec,translate ru
bind=,C,exec,translate es
bind=SHIFT,Z,exec,translate en replace
bind=SHIFT,X,exec,translate ru replace
bind=SHIFT,C,exec,translate es replace


bind=,A,exec,ai-text "Fix grammar and show updated text, keep original text structure" replace
bind=,S,exec,ai-text "Make this text more formal" replace

bind=,Z,submap,reset
bind=,X,submap,reset
bind=,C,submap,reset
bind=SHIFT,Z,submap,reset
bind=SHIFT,X,submap,reset
bind=SHIFT,C,submap,reset


bind=,A,submap,reset
bind=,S,submap,reset

bind=,escape,submap,reset 

submap=reset


$yts_submap=YTS

bind=SUPER,T,submap,$yts_submap
submap=$yts_submap

bind=,L,exec,[float; size 1400 (monitor_h*0.8); center] foot -e yts list
bind=,S,exec,yts summarize "$(wl-paste --no-newline)"
bind=,A,exec,[float; size 1400 (monitor_h*0.8); center] foot -e yts ask
bind=,T,exec,[float; size (monitor_w*0.5) (monitor_h*0.5); center] foot -e yts status
bind=,R,exec,foot -e yts retry

bind=,L,submap,reset
bind=,S,submap,reset
bind=,A,submap,reset
bind=,T,submap,reset
bind=,R,submap,reset

bind=,escape,submap,reset
submap=reset


bind=SUPER,S,exec,screenshot -r -c -n
bind=SUPER+SHIFT,S,exec,screenshot -r -e -n
bind=SUPER CTRL,S,exec,screenshot -f -e -n


bind=CTRL+SHIFT,escape,exec,[float; size (monitor_w*0.96) (monitor_h*0.96); center] $term --title 'FT htop' -e 'htop' ;
bind=CTRL+SHIFT,F1,exec,[float; size (monitor_w*0.96) (monitor_h*0.96); center] $term --title 'FT htop' -e 'btop' ;
bind=CTRL+SHIFT,F2,exec,[float; size (monitor_w*0.96) (monitor_h*0.96); center] $term --title 'FT htop' -e 'glances' ;

# bind=SUPER,N,exec,$term --title 'TODO' -e zsh -c 'nvim ~/doc/todo.md' 
# bind=SUPER,M,exec,$term --title 'NOTE' -e zsh -c 'takenote.sh' 


bind=,XF86AudioRaiseVolume,exec,pactl set-sink-volume @DEFAULT_SINK@ +5%
bind=,XF86AudioLowerVolume,exec,pactl set-sink-volume @DEFAULT_SINK@ -5%
bind=,XF86AudioMute,exec,pactl set-sink-mute @DEFAULT_SINK@ toggle
bind=,XF86AudioMicMute,exec,pactl set-source-mute @DEFAULT_SOURCE@ toggle

bind=,XF86MonBrightnessUp,exec,light -A 5
bind=,XF86MonBrightnessDown,exec,light -U 5

bind=SUPER ALT,D,exec,dark-mode-toggle

bind=,XF86AudioPlay,exec,playerctl play-pause
bind=,XF86AudioPause,exec,playerctl play-pause

bind=,XF86AudioNext,exec,playerctl next
bind=,XF86AudioPrev,exec,playerctl prev

# bindl=, XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindl=, XF86AudioPlay, exec, playerctl play-pause # the stupid key is called play , but it toggles 
bindl=, XF86AudioNext, exec, playerctl next 
bindl=, XF86AudioPrev, exec, playerctl previous

bind=SUPER,equal,exec,playerctl play-pause

bind=SUPER,minus,exec,scale-screen eDP-1 -
bind=SUPER,plus,exec,scale-screen eDP-1 +

#FIXME: not working
#bind=SUPER+CTRL,equal,exec,xdg-open "https://genius.com/search?q=$(playerctl metadata --format '{{ artist }} - {{ title }}')"

bind=SUPER,bracketright,exec,playerctl next
bind=SUPER,bracketleft,exec,playerctl previous


bind=SUPER SHIFT,bracketright,exec,wallpaper next
bind=SUPER SHIFT,bracketleft,exec,wallpaper prev
bind=SUPER SHIFT,backslash,exec,wallpaper random

$wp_submap=Wallpaper

bind=SUPER,backslash,submap,$wp_submap
submap=$wp_submap

binde=,bracketright,exec,wallpaper next # Next
binde=,bracketleft,exec,wallpaper prev # Prev

bind=,r,exec,wallpaper random # Random saved
bind=,o,exec,wallpaper oled # Download OLED
bind=,n,exec,wallpaper nature # Download Nature
bind=,p,exec,wallpaper panorama # Download Panorama
bind=SHIFT,r,exec,wallpaper # Download Random
bind=SHIFT,d,exec,wallpaper delete # Delete current

bind=,escape,submap,reset
submap=reset

bind=SUPER_SHIFT,Q,killactive
bind=SUPER SHIFT CTRL ALT,Q,exit

bind=SUPER,Y,togglefloating,
bind=SUPER SHIFT CTRL,right,cyclenext
bind=SUPER SHIFT CTRL,left,cyclenext,prev
bind=SUPER,P,pseudo,
bind=SUPER,TAB,hyprexpo:expo,toggle
bind=SUPER SHIFT,F,fullscreen,0
bind=SUPER,F,fullscreenstate, 2 0


bind=SUPER CTRL SHIFT,W,exec,killall quickshell; quickshell -p ~/nix/dotfiles/quickshell/Bar.qml &
bind=SUPER ALT,N,exec,qs -p ~/nix/dotfiles/quickshell/Bar.qml ipc call network toggle

bind=SUPER SHIFT,Y,pin,
bind=SUPER ALT,P,exec,pip-toggle

bind=SUPER,left,movefocus,l
bind=SUPER,right,movefocus,r
bind=SUPER,up,movefocus,u
bind=SUPER,down,movefocus,d

bind=SUPER,h,movefocus,l
bind=SUPER,l,movefocus,r
bind=SUPER,k,movefocus,u
bind=SUPER,j,movefocus,d

binde = SUPER ALT, right, resizeactive, 15 0
binde = SUPER ALT, left, resizeactive, -15 0
binde = SUPER ALT, up, resizeactive, 0 -15
binde = SUPER ALT, down, resizeactive, 0 15

binde = SUPER ALT, l, resizeactive, 15 0
binde = SUPER ALT, h, resizeactive, -15 0
binde = SUPER ALT, k, resizeactive, 0 -15
binde = SUPER ALT, j, resizeactive, 0 15

bind=SUPER,1,workspace,1
bind=SUPER,2,workspace,2
bind=SUPER,3,workspace,3
bind=SUPER,4,workspace,4
bind=SUPER,5,workspace,5
bind=SUPER,6,workspace,6
bind=SUPER,7,workspace,7
bind=SUPER,8,workspace,8
bind=SUPER,9,workspace,9
bind=SUPER,0,workspace,10

bind=SUPER+SHIFT,1,movetoworkspace,1
bind=SUPER+SHIFT,2,movetoworkspace,2
bind=SUPER+SHIFT,3,movetoworkspace,3
bind=SUPER+SHIFT,4,movetoworkspace,4
bind=SUPER+SHIFT,5,movetoworkspace,5
bind=SUPER+SHIFT,6,movetoworkspace,6
bind=SUPER+SHIFT,7,movetoworkspace,7
bind=SUPER+SHIFT,8,movetoworkspace,8
bind=SUPER+SHIFT,9,movetoworkspace,9
bind=SUPER+SHIFT,0,movetoworkspace,10

bind=SUPER CTRL,1,movetoworkspacesilent,1
bind=SUPER CTRL,2,movetoworkspacesilent,2
bind=SUPER CTRL,3,movetoworkspacesilent,3
bind=SUPER CTRL,4,movetoworkspacesilent,4
bind=SUPER CTRL,5,movetoworkspacesilent,5
bind=SUPER CTRL,6,movetoworkspacesilent,6
bind=SUPER CTRL,7,movetoworkspacesilent,7
bind=SUPER CTRL,8,movetoworkspacesilent,8
bind=SUPER CTRL,9,movetoworkspacesilent,9
bind=SUPER CTRL,0,movetoworkspacesilent,10

bind=SUPER+SHIFT,left,movewindow,l
bind=SUPER+SHIFT,right,movewindow,r
bind=SUPER+SHIFT,up,movewindow,u
bind=SUPER+SHIFT,down,movewindow,d

bind=SUPER,mouse_down,workspace,e+1
bind=SUPER,mouse_up,workspace,e-1



workspace = 7, layoutopt:orientation:left
workspace = 8, layoutopt:orientation:left

binde=SUPER ,R,layoutmsg,rollnext
binde=SUPER SHIFT,R,layoutmsg,rollprev

# binde=SUPER CTRL,R,layoutmsg,swapnext
# binde=SUPER CTRL SHIFT,R,layoutmsg,swapprev

bind=SUPER,Q,layoutmsg,togglesplit
bind=SUPER CTRL,Q,layoutmsg,swapsplit


$master_layout_submap=Master Layout
bind=SUPER CTRL,R,submap,$master_layout_submap
submap=$master_layout_submap
  bind=,J,layoutmsg,orientationbottom
  bind=,K,layoutmsg,orientationtop
  bind=,H,layoutmsg,orientationleft
  bind=,L,layoutmsg,orientationright
  bind=,G,layoutmsg,orientationcenter

  bind=,U,layoutmsg,orientationnext
  bind=,I,layoutmsg,orientationprev

  bind=,escape,submap,reset 
submap=reset



bind=SUPER ALT,W,exec,ha toggle switch.smart_plug_socket_1
bind=SUPER ALT,E,exec,ha toggle light.svet_v_spalne

$bedroom_submap=Bedroom

bind=SUPER ALT,B,submap,$bedroom_submap
submap=$bedroom_submap

binde=,Q,exec,ha up light.wled_bed # üîÜ Bed brighter
binde=,W,exec,ha up light.wled_monitor # üîÜ Monitor brighter
binde=,E,exec,ha up light.power_light # üîÜ Power brighter
binde=,A,exec,ha down light.wled_bed # üîÖ Bed dimmer
binde=,S,exec,ha down light.wled_monitor # üîÖ Monitor dimmer
binde=,D,exec,ha down light.power_light # üîÖ Power dimmer
bind=,Z,exec,ha toggle light.wled_bed # üí° Bed on/off
bind=,X,exec,ha toggle light.wled_monitor # üí° Monitor on/off
bind=,C,exec,ha toggle light.power_light # üí° Power on/off
bind=SHIFT,Q,exec,ha scene scene.bedroom_full_daylight # ‚òÄÔ∏è Full daylight
bind=SHIFT,W,exec,ha scene scene.bedroom_soft_daylight # üå§Ô∏è Soft daylight
bind=SHIFT,E,exec,ha scene scene.bedroom_evening_light # üåÜ Evening
bind=SHIFT,R,exec,ha scene scene.bedroom_night # üåô Night

bind=,escape,submap,reset
submap=reset

bind=ALT,R,submap,resize
submap=resize
$step=25
binde=,right,resizeactive,$step 0
binde=,left,resizeactive,-$step 0
binde=,up,resizeactive,0 -$step
binde=,down,resizeactive,0 $step

bind=,escape,submap,reset 
submap=reset

$svc_submap=Services

bind=CTRL SHIFT ALT,S,submap,$svc_submap
submap=$svc_submap

bind=,Q,exec,pkill quickshell; quickshell -p ~/nix/dotfiles/quickshell/Bar.qml &
bind=,S,exec,[float; size (monitor_w*0.8) (monitor_h*0.8); center] $term -e systemctl-tui
bind=,K,exec,[float; size (monitor_w*0.8) (monitor_h*0.8); center] $term -e kmon
bind=,J,exec,[float; size (monitor_w*0.8) (monitor_h*0.8); center] $term -e sh -c 'journalctl -f -n3000 | lnav -t'
bind=,W,exec,[float; size (monitor_w*0.6) (monitor_h*0.7); center] $term -e wifitui
bind=,Z,exec,[float; size (monitor_w*0.8) (monitor_h*0.8); center] $term -e sysz
bind=,A,exec,pkill librepodsd; sleep 0.5 && ~/dev/librepods/linux/build/librepodsd

bind=,Q,submap,reset
bind=,S,submap,reset
bind=,K,submap,reset
bind=,J,submap,reset
bind=,W,submap,reset
bind=,Z,submap,reset
bind=,A,submap,reset

bind=,escape,submap,reset
submap=reset


$power_submap=Power

bind=SUPER CTRL,l,exec,hyprctl switchxkblayout all 0 && hyprlock
bind=SUPER ALT,escape,submap,$power_submap
submap=$power_submap

bind=,s,exec,systemctl suspend
bind=SHIFT,s,exec,shutdown now
bind=,l,exec,hyprctl switchxkblayout all 0 && hyprlock
bind=,r,exec,reboot #LOLLOL
bind=,b,exec,systemctl reboot --firmware-setup

bind=,s,submap,reset
bind=,l,submap,reset
bind=,b,submap,reset

bind=,escape,submap,reset 

submap=reset

bindu=SUPER SHIFT,R,exec,hyprctl reload

layerrule = blur on, match:namespace ^(notifications)$
layerrule = ignore_alpha 0, match:namespace ^(notifications)$

layerrule = blur on, match:namespace ^(quickshell)$
layerrule = ignore_alpha 0, match:namespace ^(quickshell)$

layerrule = match:namespace ^(selection)$, animation off


windowrule = match:class ^(com\.ayugram\.desktop), focus_on_activate false
windowrule = match:class ^(com\.ayugram\.desktop), pseudo on, size 900 (monitor_h*0.95)
windowrule = match:class ^(steam)$, workspace 3
windowrule = match:class ^(com\.gabm\.satty)$, float on, max_size 2592 1296

windowrule = match:initial_title ^(Picture-in-Picture), float on
windowrule = match:initial_title ^(Picture-in-Picture), pin on
windowrule = match:initial_title ^(Picture-in-Picture), size 800 450
windowrule = match:initial_title ^(Picture-in-Picture), move (monitor_w-820) 10
windowrule = match:initial_title ^(Picture-in-Picture), opacity 0.6
windowrule = match:initial_title ^(Picture-in-Picture), no_focus on

windowrule = border_size 0, match:float 0, match:workspace w[tv1]
